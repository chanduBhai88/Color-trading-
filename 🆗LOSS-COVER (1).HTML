<script>
document.addEventListener('DOMContentLoaded', function () {
    const fullPattern = "BSBBSBSSSBSBSBBBSSBSBBBSSBBSSBBSBBSSSSSBSSS SSSSSSSSSBBSSBBSSSBSSB SBBBSBBBBSSBSSBBBBSBSSBBSBBBSSBBSSSSBBSBSSBSSSBBBSSBBSSBSBBBSSBBSSSSBSSBSSBSSBBSSSSBBSBBSBBSSBSSSBSBBSSSBBSBSBSBBSSSBBSBSBSBSSBBSBSSBBSSSSBBSSBSSBSBBSSBBBBBSSSBSSBBSSBSSBBSSSSBBSBBSBBSSBBBSSSBSSSBSBBSSSSBSBBSSSBBSBSSBBSSSBBSSBSSSBBSBBSSSSBBSBBBRSSBSBBBSBSBBSSBBBSBBSBBSSBSBBBBSBBRBBSSSBSSSBBBSSBSSSRSSBSSSSBSSBBSSBSBSSSBBSBSBB";
    const cleanPattern = fullPattern.replace(/ /g, '').replace(/R/g, 'B');

    const chunks = [];
    for (let i = 0; i < cleanPattern.length; i += 10) {
        chunks.push(cleanPattern.substring(i, i + 10));
    }

    const patternDisplay = document.getElementById('patternDisplay');
    const userInput = document.getElementById('userInput');
    const resultBtn = document.getElementById('resultBtn');
    const clearBtn = document.getElementById('clearBtn');
    const feedbackMessage = document.getElementById('feedbackMessage');
    const countdownEl = document.getElementById('countdown');

    let currentChunkIndex = 0;
    let timer;
    let secondsLeft = 5;

    function init() {
        showPattern();
    }

    function showPattern() {
        patternDisplay.textContent = chunks[currentChunkIndex];
        feedbackMessage.textContent = "";
        userInput.value = "";
        userInput.disabled = true;
        resultBtn.disabled = true;

        secondsLeft = 5;
        countdownEl.textContent = secondsLeft;

        clearInterval(timer);
        timer = setInterval(() => {
            secondsLeft--;
            countdownEl.textContent = secondsLeft;

            if (secondsLeft <= 0) {
                clearInterval(timer);
                patternDisplay.textContent = "⏱️ Time's up! Enter what you remember";
                userInput.disabled = false;
                resultBtn.disabled = false;
                userInput.focus();
            }
        }, 1000);
    }

    function checkResult() {
        const userPattern = userInput.value.toUpperCase().replace(/\s/g, '');
        if (userPattern.length !== 10) {
            feedbackMessage.textContent = "Please enter exactly 10 characters!";
            feedbackMessage.className = "incorrect";
            return;
        }
        if (!/^[BS]+$/.test(userPattern)) {
            feedbackMessage.textContent = "Only 'B' and 'S' are allowed!";
            feedbackMessage.className = "incorrect";
            return;
        }

        const currentPattern = chunks[currentChunkIndex];
        const isCorrect = userPattern === currentPattern;

        if (isCorrect) {
            feedbackMessage.textContent = "✅ Correct! Well done!";
            feedbackMessage.className = "correct";
        } else {
            feedbackMessage.textContent = `❌ Incorrect! The pattern was: ${currentPattern}`;
            feedbackMessage.className = "incorrect";
        }

        resultBtn.disabled = true;
        setTimeout(nextPattern, 2000); // 2 sec baad next pattern
    }

    function nextPattern() {
        currentChunkIndex = (currentChunkIndex + 1) % chunks.length;
        showPattern();
    }

    resultBtn.addEventListener('click', checkResult);
    clearBtn.addEventListener('click', () => {
        userInput.value = "";
        userInput.focus();
    });
    userInput.addEventListener('input', function () {
        this.value = this.value.toUpperCase().replace(/[^BS\s]/g, '');
    });

    init();
});
</script>