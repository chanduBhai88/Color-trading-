<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Big/Small 9-digit Predictor</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #0b3d91, #071029);
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    min-height: 100vh;
  }
  h1 {
    margin-bottom: 10px;
  }
  #input-display {
    font-size: 2rem;
    letter-spacing: 0.5rem;
    margin-bottom: 20px;
    min-height: 50px;
    user-select: none;
  }
  .btn-group {
    margin-bottom: 15px;
  }
  button {
    background: #0057d9;
    border: none;
    color: white;
    font-size: 1.4rem;
    padding: 10px 20px;
    margin: 5px;
    border-radius: 5px;
    cursor: pointer;
    min-width: 80px;
    user-select: none;
    transition: background 0.3s ease;
  }
  button:disabled {
    background: #444;
    cursor: not-allowed;
  }
  button:hover:not(:disabled) {
    background: #003ea8;
  }
  #result {
    font-size: 2.5rem;
    margin-top: 20px;
    min-height: 60px;
    text-align: center;
  }
  #right-wrong-buttons {
    margin-top: 20px;
  }
  #right-wrong-buttons button {
    min-width: 100px;
  }
  .stats {
    margin-top: 20px;
    font-size: 1.2rem;
  }
</style>
</head>
<body>

<h1>Big/Small 9-Digit Predictor</h1>

<div id="input-display"></div>

<div class="btn-group" id="bs-buttons">
  <button id="btn-B">B</button>
  <button id="btn-S">S</button>
  <button id="btn-Clear">Clear</button>
</div>

<div class="btn-group">
  <button id="btn-Result" disabled>Result</button>
</div>

<div id="result">Enter 9 B/S pattern</div>

<div id="right-wrong-buttons" style="display:none;">
  <button id="btn-Right">Right</button>
  <button id="btn-Wrong">Wrong</button>
</div>

<div class="stats">
  <div>Total: <span id="total-count">0</span></div>
  <div>Right: <span id="right-count">0</span></div>
  <div>Wrong: <span id="wrong-count">0</span></div>
  <div>Accuracy: <span id="accuracy">0</span>%</div>
</div>

<script>
// Extended pattern database (replace with your actual patterns)
const patterns = [
  { input: "BBBBBBBBB", result: "B" },
  { input: "SSSSSSSSS", result: "S" },
  { input: "BSBSBSBSB", result: "B" },
  { input: "SBSBSBSBS", result: "S" },
  { input: "BBBSSSBBB", result: "B" },
  { input: "SSSBBBSSS", result: "S" },
  { input: "BBSBBSBBS", result: "S" },
  { input: "SSBSBSBBS", result: "B" },
  { input: "BSSBSSBSS", result: "S" },
  { input: "SBBBSBBBS", result: "B" },
  { input: "BBSSBBSSB", result: "B" },
  { input: "SSBBSSBBS", result: "S" },
  { input: "BSBSSBSBB", result: "B" },
  { input: "SBSBBSBSB", result: "S" },
  { input: "BSSBBBSSB", result: "B" },
  { input: "SBBSSSBBS", result: "S" },
  { input: "BBSSBBSBB", result: "B" },
  { input: "SSBBSBSSB", result: "S" },
  { input: "BSBSBBSBS", result: "B" },
  { input: "SBSBSBBSB", result: "S" },
  // Add more patterns here...
];

// App state
let currentInput = "";
let awaitingFeedback = false;
let stats = {
  total: 0,
  right: 0,
  wrong: 0
};

// DOM elements
const inputDisplay = document.getElementById("input-display");
const btnB = document.getElementById("btn-B");
const btnS = document.getElementById("btn-S");
const btnClear = document.getElementById("btn-Clear");
const btnResult = document.getElementById("btn-Result");
const resultDiv = document.getElementById("result");
const rightWrongDiv = document.getElementById("right-wrong-buttons");
const btnRight = document.getElementById("btn-Right");
const btnWrong = document.getElementById("btn-Wrong");
const totalCount = document.getElementById("total-count");
const rightCount = document.getElementById("right-count");
const wrongCount = document.getElementById("wrong-count");
const accuracy = document.getElementById("accuracy");

// Improved pattern matching function
function findResult(inputStr) {
  // First try exact match
  const exactMatch = patterns.find(p => p.input === inputStr);
  if (exactMatch) return exactMatch.result;
  
  // Then try partial match (last 8 characters)
  const partial8 = inputStr.slice(1);
  const match8 = patterns.find(p => p.input.slice(1) === partial8);
  if (match8) return match8.result;
  
  // Then try partial match (last 7 characters)
  const partial7 = inputStr.slice(2);
  const match7 = patterns.find(p => p.input.slice(2) === partial7);
  if (match7) return match7.result;
  
  // Then try most common result if no matches found
  const bCount = patterns.filter(p => p.result === "B").length;
  const sCount = patterns.filter(p => p.result === "S").length;
  return bCount > sCount ? "B" : "S";
}

// Update statistics display
function updateStats() {
  totalCount.textContent = stats.total;
  rightCount.textContent = stats.right;
  wrongCount.textContent = stats.wrong;
  const acc = stats.total > 0 ? Math.round((stats.right / stats.total) * 100) : 0;
  accuracy.textContent = acc;
}

// Helper: update input display
function updateInputDisplay() {
  inputDisplay.textContent = currentInput.split("").join(" ");
  if (currentInput.length === 9) {
    resultDiv.textContent = "Click Result to predict";
  }
}

// Helper: reset all states for new input
function resetInput() {
  currentInput = "";
  updateInputDisplay();
  btnResult.disabled = true;
  rightWrongDiv.style.display = "none";
  awaitingFeedback = false;
  enableBSButtons(true);
}

// Enable or disable B/S buttons
function enableBSButtons(enable) {
  btnB.disabled = !enable;
  btnS.disabled = !enable;
  btnClear.disabled = !enable ? false : currentInput.length === 0;
}

// Event: Clicking B or S buttons
function onBSClick(char) {
  if (awaitingFeedback) return;
  if (currentInput.length < 9) {
    currentInput += char;
    updateInputDisplay();
    btnClear.disabled = false;
    if (currentInput.length === 9) {
      btnResult.disabled = false;
      enableBSButtons(false);
    }
  }
}

// Event: Clear input
function onClear() {
  if (awaitingFeedback) return;
  resetInput();
  resultDiv.textContent = "Enter 9 B/S pattern";
}

// Event: Show result after 9 inputs
function onResult() {
  if (currentInput.length !== 9) return;

  const res = findResult(currentInput);
  resultDiv.innerHTML = `Prediction: <strong>${res}</strong>`;
  
  awaitingFeedback = true;
  rightWrongDiv.style.display = "block";
  btnResult.disabled = true;
  btnClear.disabled = true;
}

// Event: User feedback on prediction
function onFeedback(isRight) {
  stats.total++;
  if (isRight) {
    stats.right++;
    resultDiv.innerHTML = "✅ Prediction was correct";
  } else {
    stats.wrong++;
    resultDiv.innerHTML = "❌ Prediction was wrong";
  }
  updateStats();
  
  // Add the new pattern to database if it didn't exist
  const existingPattern = patterns.find(p => p.input === currentInput);
  if (!existingPattern) {
    const res = resultDiv.textContent.includes("B") ? "B" : "S";
    patterns.push({
      input: currentInput,
      result: isRight ? res : (res === "B" ? "S" : "B")
    });
  }
  
  // Reset for next input after delay
  setTimeout(resetInput, 1500);
}

// Bind events
btnB.addEventListener("click", () => onBSClick("B"));
btnS.addEventListener("click", () => onBSClick("S"));
btnClear.addEventListener("click", onClear);
btnResult.addEventListener("click", onResult);
btnRight.addEventListener("click", () => onFeedback(true));
btnWrong.addEventListener("click", () => onFeedback(false));

// Keyboard support
document.addEventListener("keydown", (e) => {
  if (e.key.toUpperCase() === "B") {
    btnB.click();
  } else if (e.key.toUpperCase() === "S") {
    btnS.click();
  } else if (e.key === "Enter" && !btnResult.disabled) {
    btnResult.click();
  } else if (e.key === "Escape") {
    btnClear.click();
  }
});

// Initialize
resetInput();
updateStats();
</script>
</body>
</html>