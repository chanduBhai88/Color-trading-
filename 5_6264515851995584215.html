<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Big/Small Prediction Tool (API)</title>
<style>
  body{font-family:Segoe UI, sans-serif;background:linear-gradient(135deg,#0f172a,#1e293b);color:#fff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
  .card{background:rgba(255,255,255,0.06);padding:20px;border-radius:12px;max-width:540px;width:100%}
  h1{font-size:20px;margin-bottom:12px}
  .grid{display:flex;gap:8px;flex-wrap:wrap}
  .btn{padding:10px 12px;border-radius:8px;border:0;cursor:pointer;background:rgba(255,255,255,0.06);color:#fff}
  .btn:hover{background:rgba(255,255,255,0.12)}
  .controls{margin-top:12px;display:flex;gap:8px}
  #result{margin-top:14px;padding:12px;background:rgba(0,0,0,0.3);border-radius:8px}
  .history{margin-top:12px;max-height:160px;overflow:auto;background:rgba(255,255,255,0.03);padding:8px;border-radius:8px}
  .chip{display:inline-block;padding:6px 8px;margin:4px;border-radius:16px;background:rgba(255,255,255,0.04)}
  .error{color:#ffb4b4}
</style>
</head>
<body>
  <div class="card">
    <h1>Big/Small Prediction Tool</h1>
    <div>Click kar ke 8-digit B/S sequence banayein:</div>
    <div id="inputBox" class="grid" style="margin-top:10px"></div>

    <div class="controls">
      <button id="btnB" class="btn">B</button>
      <button id="btnS" class="btn">S</button>
      <button id="clearBtn" class="btn">Clear</button>
      <button id="resultBtn" class="btn">Get Result</button>
    </div>

    <div id="result"><strong>Result:</strong> <span id="resultText">--</span></div>
    <div id="error" class="error"></div>

    <div class="history" id="history">
      <strong>Last 10 Predictions:</strong>
      <div id="histList"></div>
    </div>
  </div>

<script>
/*
  CONFIGURE:
  - Replace API_ENDPOINT with your API URL.
  - If API requires a key, prefer server proxy. For quick test you can set API_KEY,
    but DO NOT paste secrets in public chats.
*/
const API_ENDPOINT = "https://example.com/predict"; // <-- replace with your API endpoint
const API_KEY = ""; // <-- optional; avoid using in browser for production

// UI refs
const inputBox = document.getElementById('inputBox');
const btnB = document.getElementById('btnB');
const btnS = document.getElementById('btnS');
const clearBtn = document.getElementById('clearBtn');
const resultBtn = document.getElementById('resultBtn');
const resultText = document.getElementById('resultText');
const errorDiv = document.getElementById('error');
const histList = document.getElementById('histList');

let seq = []; // stores 'B'/'S'
let history = JSON.parse(localStorage.getItem('bs_history')||'[]');

// render 8 slots
function renderSlots(){
  inputBox.innerHTML = '';
  for(let i=0;i<8;i++){
    const el = document.createElement('div');
    el.className = 'chip';
    el.style.minWidth = '36px';
    el.style.textAlign = 'center';
    el.textContent = seq[i] || '-';
    inputBox.appendChild(el);
  }
}
renderSlots();
renderHistory();

btnB.onclick = () => addChar('B');
btnS.onclick = () => addChar('S');
clearBtn.onclick = () => { seq=[]; renderSlots(); errorDiv.textContent=''; resultText.textContent='--'; }
resultBtn.onclick = () => {
  errorDiv.textContent='';
  if(seq.length !== 8){ errorDiv.textContent = 'Kripya 8 inputs bharein (B ya S).'; return; }
  // Build payload expected by API. Modify as per your API docs.
  const payload = { sequence: seq.join('') };

  // Call API
  resultText.textContent = 'Loading...';
  fetch(API_ENDPOINT, {
    method: 'POST',
    headers: {
      'Content-Type':'application/json',
      // add auth header if needed:
      ...(API_KEY ? {'Authorization': 'Bearer ' + API_KEY} : {})
    },
    body: JSON.stringify(payload),
  })
  .then(async res => {
    if(!res.ok){
      const t = await res.text();
      throw new Error('Server returned ' + res.status + ' — ' + t);
    }
    return res.json();
  })
  .then(json => {
    /*
      Expected response formats (examples). Adjust according to your API:
      { match: true, next: "B" }
      { match: false }
      { error: "..." }
    */
    if(json.error){ resultText.textContent = 'Error: ' + json.error; return; }
    if(json.match === false){ resultText.textContent = 'Result No Match'; pushHistory(seq.join('') + ' → No Match'); return; }

    const predicted = json.next || json.prediction || null;
    if(!predicted){ resultText.textContent = 'Result No Match'; pushHistory(seq.join('') + ' → No Match'); return; }

    resultText.textContent = predicted;
    pushHistory(seq.join('') + ' → ' + predicted);
  })
  .catch(err => {
    resultText.textContent = '--';
    errorDiv.textContent = 'Request failed: ' + err.message;
  });
};

function addChar(ch){
  if(seq.length >= 8) return;
  seq.push(ch);
  renderSlots();
}

function pushHistory(item){
  history.unshift({time: new Date().toISOString(), text: item});
  if(history.length>10) history = history.slice(0,10);
  localStorage.setItem('bs_history', JSON.stringify(history));
  renderHistory();
}

function renderHistory(){
  histList.innerHTML = '';
  history.forEach(h=>{
    const d = document.createElement('div');
    d.className = 'chip';
    d.style.display='block';
    d.style.padding='6px';
    d.textContent = `${h.text} (${new Date(h.time).toLocaleString()})`;
    histList.appendChild(d);
  });
}
</script>
</body>
</html>